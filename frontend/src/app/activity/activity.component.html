<section class="blog single-blog section">
  <div class="container">
      <div class="row">
          <div class="col-lg-8">
              <article class="single-post">
                  <h2 class="d-inline-block">{{ activity?.name }}</h2>
                  <div class="d-flex justify-content-between align-items-center">
                      <ul class="list-inline mb-0">
                          <li class="list-inline-item">by Admin</li>
                          <li class="list-inline-item">{{ activity?.createdAt | date:'longDate' }}</li>
                      </ul>
                  </div>

                  <img *ngIf="activity && imageUrl" [src]="imageUrl" alt="Imagen de actividad">
                  <img *ngIf="!imageUrl" src="/images/sports/no-image.png" class="img-fluid mb-4" alt="No Image">

                  <ul class="list-inline product-meta">
                      <li class="list-inline-item">
                          <a><i class="fa fa-futbol-o"></i> {{ activity?.category }}</a>
                      </li>
                  </ul>
                  <p>{{ activity?.description }}</p>

                  <h3>Detalles de la Actividad</h3>
                  <ul>
                      <li><strong>üìç Ubicaci√≥n:</strong> {{activity?.place?.name }}</li>
                      <li><strong>üìç Ubicaci√≥n - Descripci√≥n:</strong> {{ activity?.place?.description }}</li>
                      <li><strong>‚è∞ Fecha:</strong> {{ activity?.activityDate }}</li>
                      <li><strong>üë• Capacidad m√°xima:</strong> {{ activity?.vacancy }} personas</li>
                      <li><strong>üéüÔ∏è Reserva previa requerida</strong> en recepci√≥n o a trav√©s de la app del resort
                      </li>
                  </ul>
              </article>

              <div class="block comment">
                  <div class="block comment" id="allReviewsPaginated">
                      <h4>Comentarios</h4>

                      <div *ngIf="reviewsLoading">
                          <p>Cargando comentarios...</p>
                      </div>

                      <!-- Check length of reviews array, not undefined -->
                      <div *ngIf="!reviewsLoading && reviews.length > 0">
                          <div class="comment" *ngFor="let review of reviews">
                            <div class="review-header">
                                <strong>{{ review.userFullName || 'Usuario An√≥nimo' }}</strong> - {{ review.starsValue }} ‚≠ê
                                <span class="review-date">{{ review.creationDate | date:'medium' }}</span>
                            </div>
                            <p class="review-comment">{{ review.comment }}</p>
                          </div>
                      </div>

                      <!-- Only show no reviews message if not loading and array is empty -->
                      <div *ngIf="!reviewsLoading && reviews.length === 0">
                          <p>No hay comentarios a√∫n. ¬°S√© el primero en dejar uno!</p>
                      </div>
                  </div>

                  <div class="text-center mt-3" *ngIf="!reviewsLastPage && !reviewsLoading">
                      <button type="button" class="btn btn-primary" (click)="loadMoreReview()">
                        Cargar m√°s
                      </button>
                  </div>

                  <form *ngIf="register" (ngSubmit)="submitReview()">
                      <label for="starsValue">Calificaci√≥n:</label>
                      <select id="starsValue" name="starsValue" required>
                          <option value="1">1 ‚≠ê</option>
                          <option value="2">2 ‚≠ê</option>
                          <option value="3">3 ‚≠ê</option>
                          <option value="4">4 ‚≠ê</option>
                          <option value="5">5 ‚≠ê</option>
                      </select>
                      <br>
                      <label for="description">Comentario:</label>
                      <textarea id="description" name="description" required
                          style="width: 100%; height: 150px;"></textarea>
                      <br>
                      <input type="hidden" name="_csrf" [value]="token" />
                      <button type="submit" class="btn btn-primary">Enviar</button>
                  </form>
              </div>
          </div>

          <div class="col-lg-4" *ngIf="register">
              <div class="sidebar">
                  <div class="widget archive">
                      <h5 class="widget-header">Realiza aqu√≠ tu Reserva</h5>

                      <p *ngIf="isSubscribed">Ya est√°s inscrito en esta actividad.</p>

                      <form *ngIf="!isSubscribed">
                          <input type="hidden" name="_csrf" [value]="token" />
                          <button type="submit" class="btn btn-primary">RESERVAR</button>
                      </form>
                  </div>
              </div>
          </div>
      </div>
  </div>
</section>
